$(function(){$('[data-toggle="tooltip"]').tooltip()});function a(){$.ajax({method:"GET",url:"api/statistic/read.php"}).done(function(t){var a="";$.each(t,function(t,e){a+="<tr>";a+="<td>"+e.article+"</td>";a+="<td>"+e.user+"</td>";a+="<td>"+e.project+"</td>";a+="<td>"+e.date+"</td>";a+="</tr>"});$("#table-statistic").html(a)}).fail(function(t){var e="<tr>";e+="<td colspan='8'>"+t["responseJSON"].message+"</td>";e+="</tr>";$("#table-statistic").html(e)})}$("#statisticsearch").keyup(function(t){var e=$(t.target).val();if(e.length>0){$.ajax({method:"POST",url:"api/statistic/search.php",data:$(t.target).serialize()}).done(function(t){var a="";$.each(t,function(t,e){a+="<tr>";a+="<td>"+e.article+"</td>";a+="<td>"+e.user+"</td>";a+="<td>"+e.project+"</td>";a+="<td>"+e.date+"</td>";a+="</tr>"});$("#table-project").html(a)}).fail(function(t){var e="<tr>";e+="<td colspan='8'>"+t["responseJSON"].message+"</td>";e+="</tr>";$("#table-statistic").html(e)})}else{a()}});function r(){$.ajax({method:"GET",url:"api/project/read.php"}).done(function(t){var a="";$.each(t,function(t,e){a+="<tr>";a+="<td>"+e.project+"</td>";a+="<td>"+e.description+"</td>";a+="<td>"+e.user+"</td>";if(sesstoken/2647812647.28>10){a+="<td>";a+="<a href='#' data-toggle='modal' data-target='#editProjectModal' data-project-id='"+e.project_id+"' data-project='"+e.project+"' data-description='"+e.description+"'>Redigér</a>";a+="</td>";a+="<td>";a+="<a href='#' class='delete-project' data-project-id='"+e.project_id+"' data-project='"+e.project+"'>Slet</a>";a+="</td>";a+="</tr>"}});$("#table-project").html(a)}).fail(function(t){console.log(t);var e="<tr>";e+="<td colspan='8'>"+t["responseJSON"].message+"</td>";e+="</tr>";$("#table-project").html(e)})}$("#editProjectModal").on("show.bs.modal",function(t){var e=$(t.relatedTarget);var a=e.data("project-id");var r=e.data("project");var i=e.data("description");var o=$(this);o.find(".modal-body input#edit-project-id").val(a);o.find(".modal-body input#edit-project-name").val(r);o.find(".modal-body textarea").val(i)});$("#projectsearch").keyup(function(t){var e=$(t.target).val();if(e.length>0){$.ajax({method:"POST",url:"api/project/search.php",data:$(t.target).serialize()}).done(function(t){var a="";$.each(t,function(t,e){a+="<tr>";a+="<td>"+e.project+"</td>";a+="<td>"+e.description+"</td>";a+="<td>"+e.user+"</td>";a+="<td>";a+="<a href='#' data-toggle='modal' data-target='#editProjectModal' data-project-id='"+e.project_id+"' data-project='"+e.project+"' data-description='"+e.description+"'>Redigér</a>";a+="</td>";a+="<td>";a+="<a href='#' class='delete-project' data-project-id='"+e.project_id+"' data-project='"+e.project+"'>Slet</a>";a+="</td>";a+="</tr>"});$("#table-project").html(a)}).fail(function(t){var e="<tr>";e+="<td colspan='8'>"+t["responseJSON"].message+"</td>";e+="</tr>";$("#table-project").html(e)})}else{r()}});$(".form-new-project").submit(function(t){t.preventDefault();var e=$(this);$.ajax({method:"POST",url:"api/project/create.php",data:e.serialize()}).done(function(t){c(t["message"],"success");r();$(".modal").modal("hide")}).fail(function(t){c(t["responseJSON"].message,"danger")})});$(".form-edit-project").submit(function(t){t.preventDefault();var e=$(this);$.ajax({method:"POST",url:"api/project/update.php",data:e.serialize()}).done(function(t){c(t["message"],"success");r();$(".modal").modal("hide")}).fail(function(t){c(t["responseJSON"].message,"danger")})});$(document).on("click",".delete-project",function(t){var e=$(t.target).data("project-id");var a=$(t.target).data("project");if(confirm("Er du sikker på at slette projektet: "+a+"?")){$.ajax({method:"POST",url:"api/project/delete.php",data:"project_id="+e}).done(function(t){c(t["message"],"success");r()}).fail(function(t){c(t["responseJSON"].message,"danger")})}});function n(){$.ajax({method:"GET",url:"api/article/read.php"}).done(function(t){var a="";$.each(t,function(t,e){a+="<tr>";a+="<td>"+e.article+"</td>";a+="<td>"+e.category+"</td>";a+="<td>"+e.tray_number+"</td>";a+="<td>"+(e.quantity-e.on_loan)+"</td>";a+="<td>"+e.on_loan+"</td>";a+="<td>"+e.quantity+"</td>";if(sesstoken/2647812647.28>10){a+="<td>";a+="<a href='#' data-toggle='modal' data-target='#edit-article-modal' data-barcode='"+e.barcode+"'>Redigér</a>";a+="</td>";a+="<td>";a+="<a href='#' class='delete-article' data-article-id='"+e.article_id+"' data-article='"+e.article+"'>Slet</a>";a+="</td>";a+="</tr>"}});$("#table-article").html(a)}).fail(function(t){var e="<tr>";e+="<td colspan='8'>"+t["responseJSON"].message+"</td>";e+="</tr>";$("#table-article").html(e)})}$(document).on("click",".delete-article",function(t){var e=$(t.target).data("article-id");var a=$(t.target).data("article");if(confirm("Er du sikker på at slette artiklen: "+a+"?")){$.ajax({method:"POST",url:"api/article/delete.php",data:"article_id="+e}).done(function(t){c(t["message"],"success");n()}).fail(function(t){c(t["responseJSON"].message,"danger")})}});$("#articlesearch").keyup(function(t){var e=$(t.target).val();if(e.length>0){$.ajax({method:"POST",url:"api/article/search.php",data:$(t.target).serialize()}).done(function(t){var a="";$.each(t,function(t,e){a+="<tr>";a+="<td>"+e.article+"</td>";a+="<td>"+e.category+"</td>";a+="<td>"+e.tray_number+"</td>";a+="<td>"+(e.quantity-e.on_loan)+"</td>";a+="<td>"+e.on_loan+"</td>";a+="<td>"+e.quantity+"</td>";if(sesstoken/2647812647.28>10){a+="<td>";a+="<a href='#' data-toggle='modal' data-target='#edit-article-modal' data-barcode='"+e.barcode+"'>Redigér</a>";a+="</td>";a+="<td>";a+="<a href='#' class='delete-article' data-article-id='"+e.article_id+"' data-article='"+e.article+"'>Slet</a>";a+="</td>";a+="</tr>"}});$("#table-article").html(a)}).fail(function(t){var e="<tr>";e+="<td colspan='8'>"+t["responseJSON"].message+"</td>";e+="</tr>";$("#table-article").html(e)})}else{n()}});$("#form-edit-article").submit(function(t){t.preventDefault();var e=$(this);$.ajax({method:"POST",url:"api/article/update.php",data:e.serialize()}).done(function(t){c(t["message"],"success");n();$(".modal").modal("hide")}).fail(function(t){c(t["responseJSON"].message,"danger")})});$(".article-modal").on("show.bs.modal",function(t){e()});$("#edit-article-modal").on("show.bs.modal",function(t){var e=$(t.relatedTarget);var a=$(this);$.ajax({method:"POST",url:"api/article/read_one.php",data:"barcode="+e.data("barcode")}).done(function(t){a.find(".modal-body input#edit-article-id").val(t.article_id);a.find(".modal-body input#edit-article").val(t.article);a.find(".modal-body select#article-category").val(t.category_id);a.find(".modal-body input#edit-article-barcode").val(t.barcode);a.find(".modal-body input#edit-article-tray_number").val(t.tray_number);a.find(".modal-body input#edit-article-quantity").val(t.quantity)}).fail(function(t){console.log(t["responseJSON"].message)})});$("#form-new-article input").keyup(function(){var t=$("#form-new-article input#new-article-location").val();var e=$("#form-new-article input#new-article-prefix").val();var a=$("#form-new-article input#new-article-tray_number").val();if(t.length===4&&e.length===4&&a.length===4){$("input#new-article-barcode").val(t+"."+e+"."+a)}});$("#form-new-article").submit(function(t){t.preventDefault();var e=$(this);var a=e.find("#new-article-location").val();var r=e.find("#new-article-prefix").val();var i=e.find("#new-article-tray_number").val();var o=a+"."+r+"."+l(i,4);var d=e.serialize()+"&barcode="+o;$.ajax({method:"POST",url:"api/article/create.php",data:d}).done(function(t){c(t["message"],"success");n();$(".modal").modal("hide")}).fail(function(t){c(t["responseJSON"].message,"danger")})});$(".loan-article #check-barcode").click(function(t){t.preventDefault();var e=$(".loan-article #loan-barcode");var a=$(".form-loan input#loan-article");if(e.val().length>0){$.ajax({method:"POST",url:"api/article/read_one.php",data:e.serialize()}).done(function(t){a.val(t["article"]);c("Artikel fundet: "+t["article"],"success")}).fail(function(t){if(a.val().length>0){a.val("")}c(t["responseJSON"].message,"danger")})}else{c("Scan venligst en stregkode","info")}});$(".form-loan").submit(function(t){t.preventDefault();var e=$(".form-loan input#check-barcode");var a=$(".form-loan input#loan-article");if(a.val().length>0){var r=$(this);$.ajax({method:"POST",url:"api/user/loan.php",data:r.serialize()}).done(function(t){c(t.message,"success")})}else{c("Validér venligst stregkoden","success");e.focus()}});$(".modal").on("show.bs.modal",function(t){$(".alert").alert("close")});function e(){var e=$("select#article-category");$.ajax({method:"GET",url:"api/category/read.php"}).done(function(t){var a="<option value=''>Vælg Kategori</option>";$.each(t,function(t,e){a+="<option value="+e.id+">"+e.name+"</option>"});e.html(a)}).fail(function(t){e.html("<option value=''>"+t["message"]+"</option>");e.attr("disabled","disabled")})}function l(t,e){t=t.toString();return t.length<e?l("0"+t,e):t}function c(t,e){$(".alert").alert("close");var a='<div class="alert alert-'+e+' alert-dismissible fade show container notification" role="alert">';a+=t;a+='<button type="button" class="close" data-dismiss="alert" aria-label="Close">';a+='<span aria-hidden="true">&times;</span>';a+="</button>";a+="</div>";$("body").append(a);setTimeout(function(){$(".alert").alert("close")},1e4)}