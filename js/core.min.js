$(function(){$('[data-toggle="tooltip"]').tooltip()});function e(){$.ajax({method:"GET",url:"api/statistic/read.php"}).done(function(t){var e="";$.each(t,function(t,a){e+="<tr>";e+="<td>"+a.article+"</td>";e+="<td>"+a.user+"</td>";e+="<td>"+a.project+"</td>";e+="<td>"+a.date+"</td>";e+="</tr>"});$("#table-statistic").html(e)}).fail(function(t){var a="<tr>";a+="<td colspan='8'>"+t["responseJSON"].message+"</td>";a+="</tr>";$("#table-statistic").html(a)})}$("#statisticsearch").keyup(function(t){var a=$(t.target).val();if(a.length>0){$.ajax({method:"POST",url:"api/statistic/search.php",data:$(t.target).serialize()}).done(function(t){var e="";$.each(t,function(t,a){e+="<tr>";e+="<td>"+a.article+"</td>";e+="<td>"+a.user+"</td>";e+="<td>"+a.project+"</td>";e+="<td>"+a.date+"</td>";e+="</tr>"});$("#table-project").html(e)}).fail(function(t){var a="<tr>";a+="<td colspan='8'>"+t["responseJSON"].message+"</td>";a+="</tr>";$("#table-statistic").html(a)})}else{e()}});function r(){$.ajax({method:"GET",url:"api/project/read.php"}).done(function(t){var e="";$.each(t,function(t,a){e+="<tr>";e+="<td>"+a.project+"</td>";e+="<td>"+a.description+"</td>";e+="<td>"+a.user+"</td>";e+="<td>";e+="<a href='#' data-toggle='modal' data-target='#editProjectModal' data-project-id='"+a.project_id+"' data-project='"+a.project+"' data-description='"+a.description+"'>Redigér</a>";e+="</td>";e+="<td>";e+="<a href='#' class='delete-project' data-project-id='"+a.project_id+"' data-project='"+a.project+"'>Slet</a>";e+="</td>";e+="</tr>"});$("#table-project").html(e)}).fail(function(t){console.log(t);var a="<tr>";a+="<td colspan='8'>"+t["responseJSON"].message+"</td>";a+="</tr>";$("#table-project").html(a)})}$("#editProjectModal").on("show.bs.modal",function(t){var a=$(t.relatedTarget);var e=a.data("project-id");var r=a.data("project");var i=a.data("description");var o=$(this);o.find(".modal-body input#edit-project-id").val(e);o.find(".modal-body input#edit-project-name").val(r);o.find(".modal-body textarea").val(i)});$("#projectsearch").keyup(function(t){var a=$(t.target).val();if(a.length>0){$.ajax({method:"POST",url:"api/project/search.php",data:$(t.target).serialize()}).done(function(t){var e="";$.each(t,function(t,a){e+="<tr>";e+="<td>"+a.project+"</td>";e+="<td>"+a.description+"</td>";e+="<td>"+a.user+"</td>";e+="<td>";e+="<a href='#' data-toggle='modal' data-target='#editProjectModal' data-project-id='"+a.project_id+"' data-project='"+a.project+"' data-description='"+a.description+"'>Redigér</a>";e+="</td>";e+="<td>";e+="<a href='#' class='delete-project' data-project-id='"+a.project_id+"' data-project='"+a.project+"'>Slet</a>";e+="</td>";e+="</tr>"});$("#table-project").html(e)}).fail(function(t){var a="<tr>";a+="<td colspan='8'>"+t["responseJSON"].message+"</td>";a+="</tr>";$("#table-project").html(a)})}else{r()}});$(".form-new-project").submit(function(t){t.preventDefault();var a=$(this);$.ajax({method:"POST",url:"api/project/create.php",data:a.serialize()}).done(function(t){c(t["message"],"success");r();$(".modal").modal("hide")}).fail(function(t){c(t["responseJSON"].message,"danger")})});$(".form-edit-project").submit(function(t){t.preventDefault();var a=$(this);$.ajax({method:"POST",url:"api/project/update.php",data:a.serialize()}).done(function(t){c(t["message"],"success");r();$(".modal").modal("hide")}).fail(function(t){c(t["responseJSON"].message,"danger")})});$(document).on("click",".delete-project",function(t){var a=$(t.target).data("project-id");var e=$(t.target).data("project");if(confirm("Er du sikker på at slette projektet: "+e+"?")){$.ajax({method:"POST",url:"api/project/delete.php",data:"project_id="+a}).done(function(t){c(t["message"],"success");r()}).fail(function(t){c(t["responseJSON"].message,"danger")})}});function n(){$.ajax({method:"GET",url:"api/article/read.php"}).done(function(t){var e="";$.each(t,function(t,a){e+="<tr>";e+="<td>"+a.article+"</td>";e+="<td>"+a.category+"</td>";e+="<td>"+a.tray_number+"</td>";e+="<td>"+(a.quantity-a.on_loan)+"</td>";e+="<td>"+a.on_loan+"</td>";e+="<td>"+a.quantity+"</td>";e+="<td>";e+="<a href='#' data-toggle='modal' data-target='#edit-article-modal' data-barcode='"+a.barcode+"'>Redigér</a>";e+="</td>";e+="<td>";e+="<a href='#' class='delete-article' data-article-id='"+a.article_id+"' data-article='"+a.article+"'>Slet</a>";e+="</td>";e+="</tr>"});$("#table-article").html(e)}).fail(function(t){var a="<tr>";a+="<td colspan='8'>"+t["responseJSON"].message+"</td>";a+="</tr>";$("#table-article").html(a)})}$(document).on("click",".delete-article",function(t){var a=$(t.target).data("article-id");var e=$(t.target).data("article-id");if(confirm("Er du sikker på at slette artiklen: "+e+"?")){$.ajax({method:"POST",url:"api/article/delete.php",data:"article_id="+a}).done(function(t){c(t["message"],"success");n()}).fail(function(t){c(t["responseJSON"].message,"danger")})}});$("#articlesearch").keyup(function(t){var a=$(t.target).val();if(a.length>0){$.ajax({method:"POST",url:"api/article/search.php",data:$(t.target).serialize()}).done(function(t){var e="";$.each(t,function(t,a){e+="<tr>";e+="<td>"+a.article+"</td>";e+="<td>"+a.category+"</td>";e+="<td>"+a.tray_number+"</td>";e+="<td>"+(a.quantity-a.on_loan)+"</td>";e+="<td>"+a.on_loan+"</td>";e+="<td>"+a.quantity+"</td>";e+="<td>";e+="<a href='#' data-toggle='modal' data-target='#edit-article-modal' data-barcode='"+a.barcode+"'>Redigér</a>";e+="</td>";e+="<td>";e+="<a href='#' class='delete-article' data-article-id='"+a.article_id+"' data-article='"+a.article+"'>Slet</a>";e+="</td>";e+="</tr>"});$("#table-article").html(e)}).fail(function(t){var a="<tr>";a+="<td colspan='8'>"+t["responseJSON"].message+"</td>";a+="</tr>";$("#table-article").html(a)})}else{n()}});$("#form-edit-article").submit(function(t){t.preventDefault();var a=$(this);$.ajax({method:"POST",url:"api/article/update.php",data:a.serialize()}).done(function(t){c(t["message"],"success");n();$(".modal").modal("hide")}).fail(function(t){c(t["responseJSON"].message,"danger")})});$(".article-modal").on("show.bs.modal",function(t){a()});$("#edit-article-modal").on("show.bs.modal",function(t){var a=$(t.relatedTarget);var e=$(this);$.ajax({method:"POST",url:"api/article/read_one.php",data:"barcode="+a.data("barcode")}).done(function(t){e.find(".modal-body input#edit-article-id").val(t.article_id);e.find(".modal-body input#edit-article").val(t.article);e.find(".modal-body select#article-category").val(t.category_id);e.find(".modal-body input#edit-article-barcode").val(t.barcode);e.find(".modal-body input#edit-article-tray_number").val(t.tray_number);e.find(".modal-body input#edit-article-quantity").val(t.quantity)}).fail(function(t){console.log(t["responseJSON"].message)})});$("#form-new-article input").keyup(function(){var t=$("#form-new-article input#new-article-location").val();var a=$("#form-new-article input#new-article-prefix").val();var e=$("#form-new-article input#new-article-tray_number").val();if(t.length===4&&a.length===4&&e.length===4){$("input#new-article-barcode").val(t+"."+a+"."+e)}});$("#form-new-article").submit(function(t){t.preventDefault();var a=$(this);var e=a.find("#new-article-location").val();var r=a.find("#new-article-prefix").val();var i=a.find("#new-article-tray_number").val();var o=e+"."+r+"."+l(i,4);var d=a.serialize()+"&barcode="+o;$.ajax({method:"POST",url:"api/article/create.php",data:d}).done(function(t){c(t["message"],"success");n();$(".modal").modal("hide")}).fail(function(t){c(t["responseJSON"].message,"danger")})});$(".loan-article #check-barcode").click(function(t){t.preventDefault();var a=$(".loan-article #loan-barcode");var e=$(".form-loan input#loan-article");if(a.val().length>0){$.ajax({method:"POST",url:"api/article/read_one.php",data:a.serialize()}).done(function(t){e.val(t["article"]);c("Artikel fundet: "+t["article"],"success")}).fail(function(t){if(e.val().length>0){e.val("")}c(t["responseJSON"].message,"danger")})}else{c("Scan venligst en stregkode","info")}});$(".form-loan").submit(function(t){t.preventDefault();var a=$(".form-loan input#check-barcode");var e=$(".form-loan input#loan-article");if(e.val().length>0){var r=$(this);$.ajax({method:"POST",url:"api/user/loan.php",data:r.serialize()}).done(function(t){c(t.message,"success")})}else{c("Validér venligst stregkoden","success");a.focus()}});$(".modal").on("show.bs.modal",function(t){$(".alert").alert("close")});function a(){var a=$("select#article-category");$.ajax({method:"GET",url:"api/category/read.php"}).done(function(t){var e="<option value=''>Vælg Kategori</option>";$.each(t,function(t,a){e+="<option value="+a.id+">"+a.name+"</option>"});a.html(e)}).fail(function(t){a.html("<option value=''>"+t["message"]+"</option>");a.attr("disabled","disabled")})}function l(t,a){t=t.toString();return t.length<a?l("0"+t,a):t}function c(t,a){$(".alert").alert("close");var e='<div class="alert alert-'+a+' alert-dismissible fade show container notification" role="alert">';e+=t;e+='<button type="button" class="close" data-dismiss="alert" aria-label="Close">';e+='<span aria-hidden="true">&times;</span>';e+="</button>";e+="</div>";$("body").append(e);setTimeout(function(){$(".alert").alert("close")},1e4)}