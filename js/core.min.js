/* start page_load */
$(function(){$('[data-toggle="tooltip"]').tooltip()});
/* end page_load */
/* start notification */function n(t,a){$(".alert").alert("close");
// status : info, danger, success
    var e='<div class="alert alert-'+a+' alert-dismissible fade show container notification" role="alert">';e+=t;e+='<button type="button" class="close" data-dismiss="alert" aria-label="Close">';e+='<span aria-hidden="true">&times;</span>';e+="</button>";e+="</div>";$("body").append(e);setTimeout(function(){$(".alert").alert("close")},1e4)}
/* end get_statistics */
/* start get_statistics */function e(){$.ajax({method:"GET",url:"api/statistic/read.php"}).done(function(t){var e="";$.each(t,function(t,a){e+="<tr>";e+="<td>"+a.article+"</td>";e+="<td>"+a.barcode+"</td>";e+="<td>"+a.user+"</td>";e+="<td>"+a.project+"</td>";e+="<td>"+a.date+"</td>";e+="</tr>"});$("#table-statistic").html(e)}).fail(function(t){var a="<tr>";a+="<td colspan='8'>"+t["responseJSON"].message+"</td>";a+="</tr>";$("#table-statistic").html(a)})}
/* end get_statistics */
/* start statisticsearch */$("#statisticsearch").keyup(function(t){var a=$(t.target).val();if(a.length>0){$.ajax({method:"POST",url:"api/statistic/search.php",data:$(t.target).serialize()}).done(function(t){var e="";$.each(t,function(t,a){e+="<tr>";e+="<td>"+a.article+"</td>";e+="<td>"+a.user+"</td>";e+="<td>"+a.project+"</td>";e+="<td>"+a.created+"</td>";e+="</tr>"});$("#table-project").html(e)}).fail(function(t){var a="<tr>";a+="<td colspan='8'>"+t["responseJSON"].message+"</td>";a+="</tr>";$("#table-statistic").html(a)})}else{e()}});
/* end statisticsearch */
/* start get_projects */function r(){$.ajax({method:"GET",url:"api/project/read.php"}).done(function(t){var e="";$.each(t,function(t,a){e+="<tr>";e+="<td>"+a.project+"</td>";e+="<td>"+a.description+"</td>";e+="<td>"+a.user+"</td>";e+="<td>";e+="<a href='#' data-toggle='modal' data-target='#editProjectModal' data-project-id='"+a.project_id+"' data-project='"+a.project+"' data-description='"+a.description+"'>Redigér</a>";e+="</td>";e+="<td>";e+="<a href='#' class='delete-project' data-project-id='"+a.project_id+"' data-project='"+a.project+"'>Slet</a>";e+="</td>";e+="</tr>"});$("#table-project").html(e)}).fail(function(t){var a="<tr>";a+="<td colspan='8'>"+t["responseJSON"].message+"</td>";a+="</tr>";$("#table-project").html(a)})}
/* end get_projects */
/* start editProjectModal */$("#editProjectModal").on("show.bs.modal",function(t){var a=$(t.relatedTarget);var e=a.data("project-id");var r=a.data("project");var d=a.data("description");var i=$(this);i.find(".modal-body input#edit-project-id").val(e);i.find(".modal-body input#edit-project-name").val(r);i.find(".modal-body textarea").val(d)});
/* end editProjectModal */
/* start projectsearch */$("#projectsearch").keyup(function(t){var a=$(t.target).val();if(a.length>0){$.ajax({method:"POST",url:"api/project/search.php",data:$(t.target).serialize()}).done(function(t){var e="";$.each(t,function(t,a){e+="<tr>";e+="<td>"+a.project+"</td>";e+="<td>"+a.description+"</td>";e+="<td>"+a.user+"</td>";e+="<td>";e+="<a href='#' data-toggle='modal' data-target='#editProjectModal' data-project-id='"+a.project_id+"' data-project='"+a.project+"' data-description='"+a.description+"'>Redigér</a>";e+="</td>";e+="<td>";e+="<a href='#' class='delete-project' data-project-id='"+a.project_id+"' data-project='"+a.project+"'>Slet</a>";e+="</td>";e+="</tr>"});$("#table-project").html(e)}).fail(function(t){var a="<tr>";a+="<td colspan='8'>"+t["responseJSON"].message+"</td>";a+="</tr>";$("#table-project").html(a)})}else{r()}});
/* end projectsearch */
/* start form-new-project */$(".form-new-project").submit(function(t){t.preventDefault();var a=$(this);$.ajax({method:"POST",url:"api/project/create.php",data:a.serialize()}).done(function(t){n(t["message"],"success");r();$(".modal").modal("hide")}).fail(function(t){n(t["responseJSON"].message,"danger")})});
/* end form-new-project */
/* start form-edit-project */$(".form-edit-project").submit(function(t){t.preventDefault();//this will not allow browser to move to a different URL
    var a=$(this);$.ajax({method:"POST",url:"api/project/update.php",data:a.serialize()}).done(function(t){n(t["message"],"success");r();$(".modal").modal("hide")}).fail(function(t){n(t["responseJSON"].message,"danger")})});
/* end form-edit-project */
/* start delete-project */$(document).on("click",".delete-project",function(t){var a=$(t.target).data("project-id");var e=$(t.target).data("project");if(confirm("Er du sikker på at slette projektet: "+e+"?")){$.ajax({method:"POST",url:"api/project/delete.php",data:"project_id="+a}).done(function(t){n(t["message"],"success");r()}).fail(function(t){n(t["responseJSON"].message,"danger")})}});
/* end delete-project */
/* start get_articles */function l(){$.ajax({method:"GET",url:"api/article/read.php"}).done(function(t){var e="";$.each(t,function(t,a){e+="<tr>";e+="<td>"+a.article+"</td>";e+="<td>"+a.category+"</td>";e+="<td>"+a.barcode+"</td>";e+="<td>"+a.tray_number+"</td>";e+="<td>"+(a.quantity-a.on_loan)+"</td>";e+="<td>"+a.on_loan+"</td>";e+="<td>"+a.quantity+"</td>";e+="<td>";e+="<a href='#' data-toggle='modal' data-target='#editArticleModal' data-barcode='"+a.barcode+"'>Redigér</a>";e+="</td>";e+="<td>";e+="<a href='#' class='delete-article' data-article-id='"+a.article_id+"' data-article='"+a.article+"'>Slet</a>";e+="</td>";e+="</tr>"});$("#table-article").html(e)}).fail(function(t){var a="<tr>";a+="<td colspan='8'>"+t["responseJSON"].message+"</td>";a+="</tr>";$("#table-article").html(a)})}
/* end get_articles */
/* start delete-article */$(document).on("click",".delete-article",function(t){var a=$(t.target).data("article-id");var e=$(t.target).data("article-id");if(confirm("Er du sikker på at slette artiklen: "+e+"?")){$.ajax({method:"POST",url:"api/delete.php",data:"article_id="+a}).done(function(t){n(t["message"],"success");l()}).fail(function(t){n(t["responseJSON"].message,"danger")})}});
/* end delete-article */
/* start articlesearch */$("#articlesearch").keyup(function(t){var a=$(t.target).val();if(a.length>0){$.ajax({method:"POST",url:"api/article/search.php",data:$(t.target).serialize()}).done(function(t){var e="";$.each(t,function(t,a){e+="<tr>";e+="<td>"+a.article+"</td>";e+="<td>"+a.category+"</td>";e+="<td>"+a.barcode+"</td>";e+="<td>"+a.tray_number+"</td>";e+="<td>"+(a.quantity-a.on_loan)+"</td>";e+="<td>"+a.on_loan+"</td>";e+="<td>"+a.quantity+"</td>";e+="<td>";e+="<a href='#' data-toggle='modal' data-target='#editArticleModal' data-barcode='"+a.barcode+"'>Redigér</a>";e+="</td>";e+="<td>";e+="<a href='#' class='delete-article' data-article-id='"+a.article_id+"' data-article='"+a.article+"'>Slet</a>";e+="</td>";e+="</tr>"});$("#table-article").html(e)}).fail(function(t){var a="<tr>";a+="<td colspan='8'>"+t["responseJSON"].message+"</td>";a+="</tr>";$("#table-article").html(a)})}else{l()}});
/* end articlesearch */
/* start form-edit-article */$("#form-edit-article").submit(function(t){t.preventDefault();var a=$(this);$.ajax({method:"POST",url:"api/article/update.php",data:a.serialize()}).done(function(t){n(t["message"],"success");l();$(".modal").modal("hide")}).fail(function(t){n(t["responseJSON"].message,"danger")})});
/* end form-edit-article */
/* start editArticleModal */$("#editArticleModal").on("show.bs.modal",function(t){var a=$(t.relatedTarget);var e=$(this);$.ajax({method:"POST",url:"api/article/read_one.php",data:"barcode="+a.data("barcode")}).done(function(t){e.find(".modal-body input#edit-article-id").val(t.article_id);e.find(".modal-body input#edit-article").val(t.article);e.find(".modal-body select#article-category").val(t.category_id);e.find(".modal-body input#edit-article-barcode").val(t.barcode);e.find(".modal-body input#edit-article-tray_number").val(t.tray_number);e.find(".modal-body input#edit-article-quantity").val(t.quantity)}).fail(function(t){console.log(t["responseJSON"].message)})});
/* end editArticleModal */
/* start form-new-article input */$("#form-new-article input").keyup(function(){var t=$("#form-new-article input#new-article-location").val();var a=$("#form-new-article input#new-article-prefix").val();var e=$("#form-new-article input#new-article-tray_number").val();if(t.length===4&&a.length===4&&e.length===4){$("input#new-article-barcode").val(t+"."+a+"."+e)}});
/* end form-new-article input */
/* start add_beginning_zeros */function c(t,a){t=t.toString();return t.length<a?c("0"+t,a):t}
/* end add_beginning_zeros */
/* start form-new-article */$("#form-new-article").submit(function(t){t.preventDefault();var a=$(this);var e=a.find("#new-article-location").val();var r=a.find("#new-article-prefix").val();var d=a.find("#new-article-tray_number").val();var i=e+"."+r+"."+c(d,4);var o=a.serialize()+"&barcode="+i;$.ajax({method:"POST",url:"api/article/create.php",data:o}).done(function(t){n(t["message"],"success");l();$(".modal").modal("hide")}).fail(function(t){n(t["responseJSON"].message,"danger")})});
/* end form-new-article */
/* start check-barcode */$(".form-loan #check-barcode").click(function(t){t.preventDefault();var a=$(".form-loan #loan-barcode").val();if(a.length>0){$.ajax({method:"POST",url:"api/article/read_one.php",data:"barcode="+a}).done(function(t){$(".form-loan #loan-article").val(t["article"]);n("Artikel fundet: "+t["article"],"success")}).fail(function(t){n(t["responseJSON"].message,"danger");if($(".form-loan #loan-article").val().length>0){$(".form-loan #loan-article").val("")}})}else{n("Scan venligst en stregkode","info")}});
/* end check-barcode */
/* start form-loan */$(".form-loan").submit(function(t){t.preventDefault();if($(".form-loan input#loan-article").val().length>0){var a=$(this);$.ajax({method:"POST",url:"api/user/loan.php",data:a.serialize()}).done(function(t){n(t.message,"success")})}else{n("Validér stregkoden","success");$(".form-loan input#check-barcode").focus()}});
/* end form-loan */
/* start modal */$(".modal").on("show.bs.modal",function(t){$(".alert").alert("close")});
/* end form-loan */