$(function(){$('[data-toggle="tooltip"]').t();var a=$("select#article-category.js");$.o({method:"GET",url:"api/category.js/read.php"}).done(function(t){var e="<option value=''>Vælg Kategori</option>";$.l(t,function(t,a){e+="<option value="+a.id+">"+a.name+"</option>"});a.u(e)}).i(function(t){a.u("<option value=''>"+t["message"]+"</option>");a.p("disabled","disabled")});e();function e(){$.o({method:"GET",url:"api/article/read.php"}).done(function(t){var e="";$.l(t,function(t,a){e+="<tr>";e+="<td>"+a.s+"</td>";e+="<td>"+a.category+"</td>";e+="<td>"+a.$+"</td>";e+="<td>"+a.m+"</td>";e+="<td>"+(a.h-a.v)+"</td>";e+="<td>"+a.v+"</td>";e+="<td>"+a.h+"</td>";e+="<td>";e+="<a href='#' data-toggle='modal' data-target='#editArticleModal' data-barcode='"+a.$+"'>Redigér</a>";e+="</td>";e+="<td>";e+="<a href='#' class='delete-article' data-article-id='"+a.g+"' data-article='"+a.s+"'>Slet</a>";e+="</td>";e+="</tr>"});$("#table-article").u(e)}).i(function(t){var a="<tr>";a+="<td colspan='8'>"+t["T"].message+"</td>";a+="</tr>";$("#table-article").u(a)})}$(document).S("click",".delete-article",function(t){var a=$(t.target).data("article");var e=$(t.target).data("article-id");if(confirm("Er du sikker på at slette artiklen: "+a+"?")){$.o({method:"POST",url:"api/delete.php",data:"article_id="+e}).done(function(t){d(t["message"],"success");location.reload()}).i(function(t){d(t["T"].message,"danger")})}});$("#articlesearch").k(function(t){var a=$(t.target).P();if(a.length>0){$.o({method:"POST",url:"api/article/search.php",data:$(t.target).O()}).done(function(t){var e="";$.l(t,function(t,a){e+="<tr>";e+="<td>"+a.s+"</td>";e+="<td>"+a.category+"</td>";e+="<td>"+a.$+"</td>";e+="<td>"+a.m+"</td>";e+="<td>"+(a.h-a.v)+"</td>";e+="<td>"+a.v+"</td>";e+="<td>"+a.h+"</td>";e+="<td>";e+="<a href='#' data-toggle='modal' data-target='#editArticleModal' data-barcode='"+a.$+"'>Redigér</a>";e+="</td>";e+="<td>";e+="<a href='#' class='delete-article' data-article-id='"+a.g+"' data-article='"+a.s+"'>Slet</a>";e+="</td>";e+="</tr>"});$("#table-article").u(e)}).i(function(t){var a="<tr>";a+="<td colspan='8'>"+t["T"].message+"</td>";a+="</tr>";$("#table-article").u(a)})}else{$.o({method:"GET",url:"api/article/read.php"}).done(function(t){var e="";$.l(t,function(t,a){e+="<tr>";e+="<td>"+a.s+"</td>";e+="<td>"+a.category+"</td>";e+="<td>"+a.$+"</td>";e+="<td>"+a.m+"</td>";e+="<td>"+(a.h-a.v)+"</td>";e+="<td>"+a.v+"</td>";e+="<td>"+a.h+"</td>";e+="<td>";e+="<a href='#' data-toggle='modal' data-target='#editArticleModal' data-barcode='"+a.$+"'>Redigér</a>";e+="</td>";e+="<td>";e+="<a href='#' class='delete-article' data-article-id='"+a.g+"' data-article='"+a.s+"'>Slet</a>";e+="</td>";e+="</tr>"});$("#table-article").u(e)}).i(function(t){var a="<tr>";a+="<td colspan='8'>"+t["T"].message+"</td>";a+="</tr>";$("#table-article").u(a)})}});$("#form-edit-article").submit(function(t){var a=$(this);$.o({method:"POST",url:"api/article/update.php",data:a.O()}).done(function(t){d(t["message"],"success");e();$(".modal").G("hide")}).i(function(t){d(t["T"].message,"danger")});t.preventDefault()});$("#editArticleModal").S("show.bs.modal",function(t){var a=$(t.relatedTarget);var e=$(this);$.o({method:"POST",url:"api/article/read_one.php",data:"barcode="+a.data("barcode")}).done(function(t){e.find(".modal-body input#edit-article-id").P(t.g);e.find(".modal-body input#edit-article").P(t.s);e.find(".modal-body select#article-category.js").P(t.j);e.find(".modal-body input#edit-article-barcode").P(t.$);e.find(".modal-body input#edit-article-tray_number").P(t.m);e.find(".modal-body input#edit-article-quantity").P(t.h)})});$("#form-new-article input").k(function(){var t=$("#form-new-article input#new-article-location").P();var a=$("#form-new-article input#new-article-prefix").P();var e=$("#form-new-article input#new-article-tray_number").P();if(t.length===4&&a.length===4&&e.length===4){$("input#new-article-barcode").P(t+"."+a+"."+e)}});$("#form-new-article").submit(function(t){var a=$(this);$.o({method:"POST",url:"api/article/create.php",data:a.O()}).done(function(t){d(t["message"],"success");e();$(".modal").G("hide")}).i(function(t){d(t["T"].message,"danger")});t.preventDefault()});function d(t,a){var e='<div class="alert alert-'+a+' alert-dismissible fade show container notification" role="alert">';e+=t;e+='<button type="button" class="close" data-dismiss="alert" aria-label="Close">';e+='<span aria-hidden="true">&times;</span>';e+="</button>";e+="</div>";$("body").append(e);setTimeout(function(){$(".alert").alert("close")},1e4)}var i=$("select#loan-project");$.o({method:"GET",url:"api/project/read.php"}).done(function(t){var e="<option value=''>Vælg Projekt</option>";$.l(t,function(t,a){e+="<option value="+a.A+">"+a.M+", "+a.description+"</option>"});i.u(e)}).i(function(t){i.u("<option value=''>"+t["T"].message+"</option>");i.p("disabled","disabled");d(t["T"].message,"danger")});$(".form-loan #checkbarcode").click(function(t){if($(".form-loan #barcode").P().length>0){$.o({method:"GET",url:url,data:"barcode="+$(".form-loan #barcode").P(),_:"json"}).done(function(t){$(".form-loan #loan-article").P(result["R"]);d(t["message"],"success")}).i(function(t){d(t["T"].message,"danger")})}else{d("Scan venligst en stregkode","info")}t.preventDefault()});$(".form-loan").submit(function(t){var a=$(this);var e=a.p("action");$.o({method:"POST",url:e,data:a.O()}).done(function(t){alert("udlån fuldført");location.reload()});t.preventDefault()})});